# 3.7 대표적인 메모리 관련 버그

## 3.7.2 포인터 연산의 잘못된 이해

포인터 연산을 잘못 이해하면 코드의 로직이 망가질 수 있습니다.

다음은 배열의 합을 구하는 코드입니다.

```c
int sum(int* arr, int len)
{
  int sum = 0;

  for (int i = 0; i < len; i++)
  {
    sum += arr;
    arr += sizeof(int)
  }
}
```

여기서 int*의 *은 포인터를 말합니다. 어떤 배열을 가리키고 있는 포인터(arr)을 통해서 배열의 합을 구하는 것이지요. 한번 순차적으로 코드를 해석해봅시다.

첫 번째 순회때 sum에 arr을 더합니다. 배열의 포인터는 배열 전체가 아닌 배열 원소를 참조하기 떄문에 첫 순회 때 배열의 첫 번쨰 원소를 더합니다.

그러나 문제는 그 다음 줄에 있습니다. 이제 포인터를 옮겨서 배열의 다음 원소를 더 해야하는데 `sizeof(int)`를 더하고 있습니다. 다시 말해서 한 칸만 더 가면 되는데 네 칸을 더 가고 있습니다.

> 자바스크립트와 달리 C 언어의 배열은 메모리 상에 일렬로 위치해있습니다. 그래서 1바이트만 가야 다음 원소를 찾을 수 있는 것이지요.

## 3.7.8

메모리 누수는 c 언어와 같은 저수준 언어에서 흔히 발생합니다. 메모리를 요청하기만하고 해제하지 않아서 생기지요.

그러나, 자바스크립트는 상황이 조금 다릅니다. 왜냐하면 메모리를 직접 관리하지 않기 때문이지요. 그렇다고 메모리 누수가 발생하지 않는 건 아닙니다. 가비지 컬렉터가 완벽하지는 않기 때문이죠.

자바스크립트에서 메모리 누수가 발생하는 경우는 다음과 같습니다.

1. 클로저의 잘못된 사용
2. 의도치않게 생성된 전역 변수
3. 분리된 DOM 노드
4. 콘솔 출력
5. 해제하지 않은 타이머
